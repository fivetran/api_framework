{
    "MSSQL_SERVER": "your_server_address",
    "MSSQL_SERVER_DIR": "your_server_address",
    "MSSQL_PORT": "1433",
    "MSSQL_PORT_DIR": "1433",
    "MSSQL_CERT_SERVER": "your_server_address",
    "MSSQL_CERT_SERVER_DIR": "your_server_address",
    "MSSQL_DATABASE": "cdw",
    "MSSQL_USER": "your_username",
    "MSSQL_PASSWORD": "your_password",
    "MSSQL_SCHEMA": "epic",
    "cdw_cert": "",
    "src_gen_create_tbl_query": "SELECT 'CREATE OR REPLACE TABLE ' + TABLE_NAME + '(' + STRING_AGG(CAST(ColumnDefinition AS VARCHAR(MAX)), ', ') + ', _FIVETRAN_DELETED bit, _FIVETRAN_SYNCED datetime2)' AS CreateTableStatement FROM (SELECT TABLE_NAME, COLUMN_NAME + ' ' + CASE WHEN DATA_TYPE IN ('numeric', 'decimal') THEN DATA_TYPE + '(' + CAST(NUMERIC_PRECISION AS VARCHAR) + ', ' + CAST(NUMERIC_SCALE AS VARCHAR) + ')' WHEN DATA_TYPE IN ('varchar', 'nvarchar', 'char', 'nchar') AND CHARACTER_MAXIMUM_LENGTH = -1 THEN DATA_TYPE + '(MAX)' WHEN DATA_TYPE IN ('varchar', 'nvarchar', 'char', 'nchar') THEN DATA_TYPE + '(' + CAST(CHARACTER_MAXIMUM_LENGTH AS VARCHAR) + ')' ELSE DATA_TYPE END AS ColumnDefinition FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = '{table}' AND TABLE_SCHEMA = 'epic') AS TableColumnDefinitions GROUP BY TABLE_NAME",
    "src_pk_join_conditions": "SELECT CONCAT(STRING_AGG('INC.' + QUOTENAME(COL.COLUMN_NAME) + ' = TGT.' + QUOTENAME(COL.COLUMN_NAME), ' AND '), '|', STRING_AGG(QUOTENAME(COL.COLUMN_NAME), ', ')) AS joincondition FROM INFORMATION_SCHEMA.COLUMNS AS COL INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU ON COL.TABLE_NAME = KCU.TABLE_NAME AND COL.COLUMN_NAME = KCU.COLUMN_NAME AND COL.TABLE_SCHEMA = KCU.TABLE_SCHEMA WHERE COL.TABLE_NAME = '{table}' AND COL.TABLE_SCHEMA = 'epic' AND KCU.CONSTRAINT_NAME LIKE 'PK_%' ORDER BY KCU.ORDINAL_POSITION",
    "src_upsert_records": "SELECT TGT.*, CAST(0 AS bit) AS _FIVETRAN_DELETED, CURRENT_TIMESTAMP AS _FIVETRAN_SYNCED FROM {tableName} TGT WITH (NOLOCK) WHERE TGT._LastUpdatedInstant >= '{endDate}' AND TGT._LastUpdatedInstant < '{startDate}' ORDER BY TGT._LastUpdatedInstant",
    "src_del_records": "SELECT {joincol} FROM {tableName} inc WITH (NOLOCK) WHERE inc._LastUpdatedInstant >= '{endDate}' AND inc._LastUpdatedInstant < '{startDate}'",
    "src_val_record_count": "SELECT COUNT_BIG(*) AS row_count FROM {tableName} WITH (NOLOCK)",
    "des_val_record_count": "SELECT COUNT_BIG(*) AS row_count FROM {tableName} WITH (NOLOCK) WHERE _FIVETRAN_DELETED = 0",
    "src_fl_records": "SELECT *, CAST(0 AS bit) AS _FIVETRAN_DELETED, CURRENT_TIMESTAMP AS _FIVETRAN_SYNCED FROM {tableName} WITH (NOLOCK) WHERE {indexkey} >= '{lowerbound}' AND {indexkey} <= '{upperbound}' ORDER BY {indexkey}",
    "src_gen_index_column": "SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = '{table}' AND TABLE_SCHEMA = 'epic' ORDER BY ORDINAL_POSITION",
    "src_gen_index_column_bounds": "WITH full_count AS (SELECT COUNT_BIG(*) AS rcnt FROM {tableName} WITH (NOLOCK)), group_count AS (SELECT {indexkey}, COUNT_BIG(*) AS rcnt FROM {tableName} WITH (NOLOCK) WHERE {indexkey} IS NOT NULL GROUP BY {indexkey}), parent_counts AS (SELECT group_count.{indexkey}, group_count.rcnt, (SELECT rcnt FROM full_count) AS tcnt FROM group_count), silky AS (SELECT parent_counts.{indexkey}, parent_counts.rcnt, parent_counts.tcnt, CASE WHEN tcnt < 10000 THEN 1 ELSE CAST({threads} AS INT) END AS silkysheets FROM parent_counts), splitsizes AS (SELECT {indexkey}, rcnt, tcnt, silkysheets, CAST(tcnt / NULLIF(silkysheets, 0) AS NUMERIC(20, 0)) AS splitsize FROM silky), runningsplits AS (SELECT {indexkey}, splitsize, tcnt, silkysheets, SUM(rcnt) OVER (ORDER BY {indexkey} ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS splitsum FROM splitsizes), threadgroups AS (SELECT {indexkey}, splitsize, tcnt, silkysheets, CASE WHEN CAST(splitsum / NULLIF(splitsize, 0) AS NUMERIC(20, 0)) >= silkysheets - 1 THEN silkysheets - 1 ELSE CAST(splitsum / NULLIF(splitsize, 0) AS NUMERIC(20, 0)) END AS threadgroup FROM runningsplits), minmax AS (SELECT threadgroup, splitsize, tcnt, silkysheets, MIN({indexkey}) AS min_ord1pk, MAX({indexkey}) AS max_ord1pk FROM threadgroups GROUP BY threadgroup, splitsize, tcnt, silkysheets) SELECT threadgroup, min_ord1pk AS lowerbound, max_ord1pk AS upperbound, splitsize, tcnt, silkysheets FROM minmax ORDER BY threadgroup",
    "des_val_insert_query": "INSERT INTO validation_results (table_name, validation_test, des_count, src_count, run_date, run_name, run_type, list_loc, run_id, rep_id, has_predicate, profile) VALUES ('{tblparam}', '{val_type}', {des_count_val}, {src_count_val}, '{start_time}', '{run_name}', '{run_type}', '{list_loc}', '{run_id}', '{rep_id}', {has_predicate}, '{profile}')",
    "schema_table_list_query": "SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WITH (NOLOCK) WHERE TABLE_SCHEMA = 'epic' AND TABLE_TYPE = 'BASE TABLE' AND TABLE_NAME IN ('ACCUMULATIONINSTANCEFACT_BUSINESSKEYLOOKUP', 'CAREMANAGEMENTTRAITFACT_BUSINESSKEYLOOKUP') ORDER BY TABLE_NAME",
    "schema_table_list_query_debug": "SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WITH (NOLOCK) WHERE TABLE_SCHEMA = 'epic' AND TABLE_TYPE = 'BASE TABLE' AND TABLE_NAME IN ('SURVEYANSWERFACT_BUSINESSKEYLOOKUP') ORDER BY TABLE_NAME",
    "schema_pk_query": "SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WITH (NOLOCK) WHERE TABLE_NAME = '{table}' AND TABLE_SCHEMA = 'epic' AND CONSTRAINT_NAME LIKE 'PK_%' ORDER BY ORDINAL_POSITION",
    "schema_col_query": "SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM INFORMATION_SCHEMA.COLUMNS WITH (NOLOCK) WHERE TABLE_NAME = '{table}' AND TABLE_SCHEMA = 'epic' ORDER BY ORDINAL_POSITION",
    "threads": "4",
    "max_queue_size": "0",
    "max_retries": "5",
    "retry_sleep_seconds": "5",
    "debug": "false"
}
